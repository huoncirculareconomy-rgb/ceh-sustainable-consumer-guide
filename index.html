<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CEH Sustainable Consumer Guide</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body {
  margin: 0;
  font-family: system-ui, Arial, sans-serif;
  background: #f6f3ee;
  color: #24323f;
}

.container {
  max-width: 1200px;
  margin: auto;
  padding: 16px;
}

h1 {
  color: #2f8f5b;
  margin-bottom: 4px;
}

/* Rotating slogan */
#slogan {
  font-style: italic;
  margin-bottom: 16px;
  min-height: 1.4em;
  color: #444;
}

#slogan a {
  color: inherit;
  text-decoration: none;
}

#slogan a:hover {
  text-decoration: underline;
}

/* Filters */
.filters {
  display: grid;
  grid-template-columns: 1fr 220px 220px auto;
  gap: 10px;
  margin-bottom: 10px;
}

.filters input,
.filters select,
.filters button {
  padding: 8px 10px;
  font-size: 14px;
}

#resetBtn {
  background: #1a73e8;
  color: #fff;
  border: 1px solid #1a73e8;
  border-radius: 6px;
  cursor: pointer;
}

#resetBtn:hover {
  background: #1558b0;
}

@media (max-width: 800px) {
  .filters {
    grid-template-columns: 1fr;
  }
}

.results-count {
  font-size: 13px;
  margin: 8px 0 12px;
}

/* Cards */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 16px;
}

.card {
  background: #fbfaf8;
  border: 1px solid #ddd;
  border-radius: 14px;
  padding: 14px;
}

.card h3 {
  margin: 0 0 6px 0;
  font-size: 16px;
}

.description {
  font-size: 14px;
  line-height: 1.45;
  margin-bottom: 8px;
}

/* Pills */
.category-tag,
.practice-tag {
  display: inline-block;
  padding: 4px 10px;
  font-size: 12px;
  border-radius: 999px;
  margin: 3px 4px 0 0;
  cursor: pointer;
}

.category-tag {
  background: #e6f0ff;
  color: #2457c5;
  border: 1px solid #bcd2ff;
}

.practice-tag {
  background: #e7f5ea;
  color: #1b7f4d;
  border: 1px solid #bfe3cc;
}

/* Contact */
.contact {
  font-size: 13px;
  margin-top: 8px;
}

.contact-item {
  display: flex;
  gap: 6px;
  margin-top: 3px;
}

.contact-item a {
  color: #1a73e8;
  text-decoration: none;
  font-size: 13px;
  word-break: break-word;
}

.contact-item a:hover {
  text-decoration: underline;
}

/* Notes */
.notes {
  margin-top: 10px;
  padding-top: 8px;
  border-top: 1px solid #eee;
  color: #777;
  font-style: italic;
  font-size: 13px;
}

/* Footer */
.footer {
  margin-top: 24px;
  font-size: 12px;
  color: #666;
  text-align: center;
}
</style>
</head>

<body>
<div class="container">

  <h1>CEH Sustainable Consumer Guide</h1>
  <div id="slogan">Loading…</div>

  <div class="filters">
    <input id="searchInput" placeholder="Search name, product, category or practice…">
    <select id="locationFilter"><option value="">All locations</option></select>
    <select id="practiceFilter"><option value="">All practices</option></select>
    <button id="resetBtn">Reset filters</button>
  </div>

  <div class="results-count" id="resultsCount"></div>
  <div class="cards" id="cards"></div>

  <div class="footer" id="lastUpdated"></div>

</div>

<script>
/* ======================
   CONFIG
====================== */
const DATA_CSV =
  "https://docs.google.com/spreadsheets/d/1Nm4LnfbmopYYSSRL6oGt2trWsIehBKYeUf_rl2pKYYg/export?format=csv&gid=2076497318";

const SLOGAN_CSV =
  "https://docs.google.com/spreadsheets/d/1Nm4LnfbmopYYSSRL6oGt2trWsIehBKYeUf_rl2pKYYg/export?format=csv&gid=435440157";

/* ======================
   SLOGANS
====================== */
let slogans = [];
let sloganIndex = 0;
let sloganTimer = null;

function loadSlogans() {
  Papa.parse(SLOGAN_CSV, {
    download: true,
    header: false,
    complete: res => {
      slogans = res.data
        .map(r => ({
          text: r[0]?.trim(),
          url: r[1]?.trim(),
          seconds: parseInt(r[2], 10) || 5
        }))
        .filter(s => s.text);

      if (slogans.length) rotateSlogan();
    }
  });
}

function rotateSlogan() {
  const s = slogans[sloganIndex];
  const el = document.getElementById("slogan");

  el.innerHTML = s.url
    ? `<a href="${s.url}" target="_blank">${s.text}</a>`
    : s.text;

  clearTimeout(sloganTimer);
  sloganTimer = setTimeout(() => {
    sloganIndex = (sloganIndex + 1) % slogans.length;
    rotateSlogan();
  }, s.seconds * 1000);
}

/* ======================
   START
====================== */
loadSlogans();
</script>
</body>
</html>
