<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CEH Sustainable Consumer Guide</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
/*
=========================================================
Sustainable Consumer Guide
Purpose:
  Display filterable business cards from Google Sheet CSV.
  Includes category filtering, practice filtering, search,
  rotating slogans, and contact details with icons and
  Google Maps address links.

Version: 1.1
Last Modified: 13 February 2026

Change Log:
  v1.0  Governance framework adopted
  v1.1  Rolled back vertical alignment feature
=========================================================
*/

:root{
  --bg:#f6f3ef;
  --panel:#fbf8f4;
  --card:#f8f6f3;
  --border:#d9d9d9;
  --text:#24323f;
  --muted:#777;
  --title:#2e8b57;

  --blue-bg:#e6f0ff;
  --blue-bd:#bcd2ff;
  --blue-tx:#0b3ea9;

  --green-bg:#e7f6ea;
  --green-bd:#b9e2c2;
  --green-tx:#1a6b2f;

  --pill-active:#333;
  --btn:#1f66d1;
  --btn-dark:#154ea3;
}

*{ box-sizing:border-box }

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}

.wrap{
  max-width:1200px;
  margin:auto;
  padding:22px 18px 28px;
}

h1{
  text-align:center;
  color:var(--title);
  margin:8px 0 4px;
}

.slogan{
  text-align:center;
  font-style:italic;
  min-height:1.4em;
  margin-bottom:18px;
}

.controls{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px;
}

.controls-row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}

.input,.select,.btn{
  height:42px;
  padding:0 12px;
  font-size:14px;
  border-radius:8px;
  border:1px solid #7d7d7d;
}

.input{ flex:1 1 360px; }
.select{ flex:0 1 220px; }

.btn{
  background:var(--btn);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}
.btn:hover{ background:var(--btn-dark); }

.grid{
  margin-top:16px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:16px;
}

@media(max-width:900px){
  .grid{ grid-template-columns:repeat(2,1fr); }
}
@media(max-width:600px){
  .grid{ grid-template-columns:1fr; }
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px;
  display:flex;
  flex-direction:column;
}

.name{
  font-weight:600;
  color:#3a3a3a;
  margin-bottom:8px;
}

.bullets{
  display:grid;
  gap:6px;
  margin-bottom:10px;
}

.bullet{
  display:grid;
  grid-template-columns:14px 1fr;
  gap:6px;
  font-size:13.5px;
}

.chev{ font-weight:700; }

.pills{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-bottom:8px;
}

.pill{
  font-size:12px;
  padding:3px 9px;
  border-radius:999px;
  border:1px solid transparent;
  background:none;
  cursor:pointer;
}

.pill.blue{
  background:var(--blue-bg);
  border-color:var(--blue-bd);
  color:var(--blue-tx);
}

.pill.green{
  background:var(--green-bg);
  border-color:var(--green-bd);
  color:var(--green-tx);
}

.pill.active{
  box-shadow:0 0 0 1px var(--pill-active);
  font-weight:600;
}

.contact{
  border-top:1px solid var(--border);
  padding-top:10px;
  margin-top:10px;
  font-size:12.5px;
  color:var(--muted);
  display:grid;
  gap:6px;
}

.contact-row{
  display:flex;
  align-items:flex-start;
  gap:6px;
}

.icon{
  width:16px;
  text-align:center;
}

.contact a{
  color:var(--blue-tx);
  text-decoration:none;
}
.contact a:hover{
  text-decoration:underline;
}

footer{
  margin-top:18px;
  text-align:center;
  font-size:12.5px;
  color:var(--muted);
}
</style>
</head>

<body>
<div class="wrap">

<h1>CEH Sustainable Consumer Guide</h1>
<div class="slogan" id="slogan"></div>

<div class="controls">
  <div class="controls-row">
    <input id="search" class="input" placeholder="Search‚Ä¶" />
    <select id="locationFilter" class="select"></select>
    <select id="practiceFilter" class="select"></select>
    <button class="btn" onclick="resetFilters()">Reset filters</button>
  </div>
  <div class="meta" id="resultCount"></div>
</div>

<div class="grid" id="cards"></div>
<footer id="updated"></footer>

</div>

<script>

/* -----------------------------------------------------
Function: splitClean
Purpose: Split comma-separated fields into trimmed array
Inputs:  String
Returns: Array
----------------------------------------------------- */
const splitClean = v =>
  v ? v.split(",").map(x=>x.trim()).filter(Boolean) : [];

/* -----------------------------------------------------
Function: bulletise
Purpose: Convert sentence string into bullet blocks
Inputs:  String
Returns: HTML string
----------------------------------------------------- */
const bulletise = text =>
  text ? text.split(".").map(t=>t.trim()).filter(Boolean)
    .map(t=>`
      <div class="bullet">
        <div class="chev">&gt;</div>
        <div>${t}.</div>
      </div>`).join("") : "";

/* -----------------------------------------------------
Function: buildContact
Purpose: Render contact block with icons and
         Google Maps link for address
Inputs:  Row object
Returns: HTML string
----------------------------------------------------- */
function buildContact(r){
  const website = r.Website?.trim();
  const phone = r.Phone?.trim();
  const email = r.Email?.trim();
  const address = r.Address?.trim();

  if(!website && !phone && !email && !address) return "";

  const mapLink = address
    ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`
    : "";

  return `
    <div class="contact">
      ${website ? `<div class="contact-row"><div class="icon">üåê</div><div><a href="${website.startsWith('http')?website:'https://'+website}" target="_blank">${website}</a></div></div>` : ""}
      ${phone ? `<div class="contact-row"><div class="icon">‚òé</div><div><a href="tel:${phone.replace(/\s+/g,'')}">${phone}</a></div></div>` : ""}
      ${email ? `<div class="contact-row"><div class="icon">‚úâ</div><div><a href="mailto:${email}">${email}</a></div></div>` : ""}
      ${address ? `<div class="contact-row"><div class="icon">üìç</div><div><a href="${mapLink}" target="_blank">${address}</a></div></div>` : ""}
    </div>
  `;
}

/* Remaining core logic unchanged ‚Äî CSV loading,
   filters, pill toggling, rendering, slogan rotation */

</script>
</body>
</html>
